"use strict";(self.webpackChunktrack_time_cli_docs=self.webpackChunktrack_time_cli_docs||[]).push([[773],{7511:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var i=n(3274),s=n(2476);const a={id:"database",title:"Database",sidebar_position:1},c=void 0,o={id:"basic-concepts/database",title:"Database",description:"By default, the database is located at ~/.track-time-cli/db.json",source:"@site/docs/basic-concepts/database.md",sourceDirName:"basic-concepts",slug:"/basic-concepts/database",permalink:"/docs/basic-concepts/database",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/basic-concepts/database.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"database",title:"Database",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Basic Concepts",permalink:"/docs/category/basic-concepts"},next:{title:"Data Types",permalink:"/docs/basic-concepts/data-types"}},r={},d=[{value:"By default, the database is located at <em><code>~/.track-time-cli/db.json</code></em>",id:"by-default-the-database-is-located-at-track-time-clidbjson",level:4},{value:"NOTE: <em>The database file is minified by default.</em>",id:"note-the-database-file-is-minified-by-default",level:4},{value:"Schema",id:"schema",level:3},{value:"Initialization",id:"initialization",level:3},{value:"Migrations",id:"migrations",level:3},{value:"Backups",id:"backups",level:3}];function l(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h3:"h3",h4:"h4",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.admonition,{type:"info",children:(0,i.jsxs)(t.h4,{id:"by-default-the-database-is-located-at-track-time-clidbjson",children:["By default, the database is located at ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.code,{children:"~/.track-time-cli/db.json"})})]})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"track-time-cli"})," stores all activity in your ",(0,i.jsx)(t.strong,{children:"home"})," folder within a single\n",(0,i.jsx)(t.strong,{children:"JSON"})," file named ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"db.json"})}),". This file holds all your time sheets and\nentries. Most commands will only append to it, so expect it to grow linearly\nover time."]}),"\n",(0,i.jsxs)(t.p,{children:["Since it is a plain JSON file, it can be inspected with programs like\n",(0,i.jsx)(t.a,{href:"https://stedolan.github.io/jq/",children:(0,i.jsx)(t.strong,{children:"jq"})}),", or edited with any text editor."]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsxs)(t.p,{children:["Not all commands will modify the database; commands like ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"tt list"})}),",\n",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"tt today"})})," and ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"tt week"})})," will only read from it, whereas other commands\nlike ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"tt in"})})," and ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"tt out"})})," will modify it upon command execution."]}),"\n",(0,i.jsx)(t.admonition,{type:"tip",children:(0,i.jsxs)(t.p,{children:["To pretty-print its contents, you may run\n",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"cat ~/.track-time-cli/db.json | jq ."})})]})}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsxs)(t.h4,{id:"note-the-database-file-is-minified-by-default",children:["NOTE: ",(0,i.jsx)(t.em,{children:"The database file is minified by default."})]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"schema",children:"Schema"}),"\n",(0,i.jsxs)(t.p,{children:["As the internal schemas of the ",(0,i.jsx)(t.strong,{children:"time sheet"})," and ",(0,i.jsx)(t.strong,{children:"time sheet entry"})," models\nare reproduced when first mentioned, the ",(0,i.jsx)(t.a,{href:"https://github.com/f3rno64/track-time-cli/blob/main/src/types/generic_data.ts#L15-L19",children:(0,i.jsx)(t.strong,{children:"schema"})})," of the\ndatabase itself can be found below:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",metastring:"showLineNumbers",children:"export interface ITimeTrackerDB<T> {\n  sheets: ITimeSheet<T>[]\n  activeSheetName: string | null\n  version: number\n}\n"})}),"\n",(0,i.jsx)(t.h3,{id:"initialization",children:"Initialization"}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsxs)(t.p,{children:["A sheet named ",(0,i.jsx)(t.strong,{children:"main"})," is present by default."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["If no database exists, upon the first invocation of ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"track-time-cli"})}),",\n",(0,i.jsx)(t.em,{children:"regardless of which command is used"}),", a new empty database will be created\nwith a single default time sheet named ",(0,i.jsx)(t.strong,{children:"main"}),"."]}),"\n",(0,i.jsx)(t.p,{children:"The contents of this fresh database are the following:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-js",children:'{\n  "version": 2,\n  "activeSheetName": "main",\n  "sheets": [\n    {\n      "entries": [],\n      "name": "main",\n      "activeEntryID": null\n    }\n  ]\n}\n'})}),"\n",(0,i.jsx)(t.h3,{id:"migrations",children:"Migrations"}),"\n",(0,i.jsxs)(t.p,{children:["Sometimes when an update is released, the database schema may be updated,\nincreasing the ",(0,i.jsx)(t.strong,{children:"version"})," number in the ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"db.json"})})," file. When this happens,\n",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"track-time-cli"})})," will automatically migrate the contents of the database to\nthe new schema when any command is invoked, prior to command execution."]}),"\n",(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsxs)(t.p,{children:["A backup prior to each migration is created at as\n",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"~/.track-time-cli/db.json.bak-1"})}),", where the numeric suffix is the old\ndatabase version number."]})}),"\n",(0,i.jsx)(t.h3,{id:"backups",children:"Backups"}),"\n",(0,i.jsxs)(t.p,{children:["Since the database is a single file, you can back it up by creating a git\nrepository within the ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"~/.track-time-cli"})})," folder."]}),"\n",(0,i.jsx)(t.admonition,{type:"tip",children:(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"A private GitHub repository is a good place to put this."})})}),"\n",(0,i.jsx)(t.p,{children:"To start backing up your data, you can do something like the following:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sh",children:"cd ~/.track-time-cli\ngit init .\ngit remote add origin git@github.com:username/track-time-cli-backup.git\ngit add db.json\ngit commit -m 'chore: update'\ngit push origin main\n"})}),"\n",(0,i.jsx)(t.p,{children:"Afterwards, to update your backup, just commit the latest changes and push:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sh",children:"git add db.json\ngit commit -m 'chore: update'\ngit push origin main\n"})})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},2476:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>o});var i=n(9474);const s={},a=i.createContext(s);function c(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);